import{l as J,p as ve,m as K,e as b,n as q,j as G,q as pe,s as N,v as B,x as we,y as de,z as A,A as me,C as be,B as F,D as ke,E as Ve,G as Te,H as Se,I as Be,J as xe,K as le,L as Ee,u as Pe,M as _e,N as Ce,O as Ie,P as Me,r as fe,Q as Le,R as Z,S as De,T as Ne,U as Re,W as He,X as Ye,Y as $e,Z as Ae,_ as We,$ as Oe,a0 as Xe,a1 as ze,a2 as Ue,a3 as Fe,d as E,a4 as qe,a5 as Ze,a6 as je,a7 as Ge,F as W,a as Je,a8 as Ke,f as z,w as S,a9 as Qe,b as et,o as x,c as _,aa as $,k as M,i as re,ab as j,t as U,g as L,ac as tt}from"./index-BxHN7eqe.js";import{V as at}from"./VAppBar-iI02Al44.js";import{u as ot}from"./ssrBoot-DDSpbYyQ.js";import{V as nt}from"./VMain-BELk7lsB.js";import{m as lt,V as rt}from"./VToolbar-j8GpEdDx.js";import{V as se}from"./VBadge-DoVd7q1h.js";import{V as st}from"./VList-CiRUSjkD.js";import{V as ue}from"./VListItem-Jep9xHel.js";import"./VDivider-Dpyx-vhS.js";const ut=ve({...pe({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),it=J()({name:"VAppBarNavIcon",props:ut(),setup(e,o){let{slots:r}=o;return K(()=>b(G,q(e,{class:["v-app-bar-nav-icon"]}),r)),{}}}),ct=J()({name:"VAppBarTitle",props:lt(),setup(e,o){let{slots:r}=o;return K(()=>b(rt,q(e,{class:"v-app-bar-title"}),r)),{}}});function vt(e){let{rootEl:o,isSticky:r,layoutItemStyles:T}=e;const t=N(!1),c=N(0),n=B(()=>{const g=typeof t.value=="boolean"?"top":t.value;return[r.value?{top:"auto",bottom:"auto",height:void 0}:void 0,t.value?{[g]:we(c.value)}:{top:T.value.top}]});de(()=>{A(r,g=>{g?window.addEventListener("scroll",s,{passive:!0}):window.removeEventListener("scroll",s)},{immediate:!0})}),me(()=>{window.removeEventListener("scroll",s)});let i=0;function s(){const g=i>window.scrollY?"up":"down",a=o.value.getBoundingClientRect(),f=parseFloat(T.value.top??0),m=window.scrollY-Math.max(0,c.value-f),h=a.height+Math.max(c.value,f)-window.scrollY-window.innerHeight,w=parseFloat(getComputedStyle(o.value).getPropertyValue("--v-body-scroll-y"))||0;a.height<window.innerHeight-f?(t.value="top",c.value=f):g==="up"&&t.value==="bottom"||g==="down"&&t.value==="top"?(c.value=window.scrollY+a.top-w,t.value=!0):g==="down"&&h<=0?(c.value=0,t.value="bottom"):g==="up"&&m<=0&&(w?t.value!=="top"&&(c.value=-m+w+f,t.value="top"):(c.value=a.top+m,t.value="top")),i=window.scrollY}return{isStuck:t,stickyStyles:n}}const dt=100,mt=20;function ie(e){return(e<0?-1:1)*Math.sqrt(Math.abs(e))*1.41421356237}function ce(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let o=0;for(let r=e.length-1;r>0;r--){if(e[r].t===e[r-1].t)continue;const T=ie(o),t=(e[r].d-e[r-1].d)/(e[r].t-e[r-1].t);o+=(t-T)*Math.abs(t),r===e.length-1&&(o*=.5)}return ie(o)*1e3}function ft(){const e={};function o(t){Array.from(t.changedTouches).forEach(c=>{(e[c.identifier]??(e[c.identifier]=new be(mt))).push([t.timeStamp,c])})}function r(t){Array.from(t.changedTouches).forEach(c=>{delete e[c.identifier]})}function T(t){var g;const c=(g=e[t])==null?void 0:g.values().reverse();if(!c)throw new Error(`No samples for touch id ${t}`);const n=c[0],i=[],s=[];for(const a of c){if(n[0]-a[0]>dt)break;i.push({t:a[0],d:a[1].clientX}),s.push({t:a[0],d:a[1].clientY})}return{x:ce(i),y:ce(s),get direction(){const{x:a,y:f}=this,[m,h]=[Math.abs(a),Math.abs(f)];return m>h&&a>=0?"right":m>h&&a<=0?"left":h>m&&f>=0?"down":h>m&&f<=0?"up":gt()}}}return{addMovement:o,endTouch:r,getVelocity:T}}function gt(){throw new Error}function ht(e){let{el:o,isActive:r,isTemporary:T,width:t,touchless:c,position:n}=e;de(()=>{window.addEventListener("touchstart",C,{passive:!0}),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("touchend",O,{passive:!0})}),me(()=>{window.removeEventListener("touchstart",C),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",O)});const i=B(()=>["left","right"].includes(n.value)),{addMovement:s,endTouch:g,getVelocity:a}=ft();let f=!1;const m=N(!1),h=N(0),w=N(0);let V;function R(l,u){return(n.value==="left"?l:n.value==="right"?document.documentElement.clientWidth-l:n.value==="top"?l:n.value==="bottom"?document.documentElement.clientHeight-l:D())-(u?t.value:0)}function H(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const v=n.value==="left"?(l-w.value)/t.value:n.value==="right"?(document.documentElement.clientWidth-l-w.value)/t.value:n.value==="top"?(l-w.value)/t.value:n.value==="bottom"?(document.documentElement.clientHeight-l-w.value)/t.value:D();return u?ke(v):v}function C(l){if(c.value)return;const u=l.changedTouches[0].clientX,v=l.changedTouches[0].clientY,d=25,y=n.value==="left"?u<d:n.value==="right"?u>document.documentElement.clientWidth-d:n.value==="top"?v<d:n.value==="bottom"?v>document.documentElement.clientHeight-d:D(),p=r.value&&(n.value==="left"?u<t.value:n.value==="right"?u>document.documentElement.clientWidth-t.value:n.value==="top"?v<t.value:n.value==="bottom"?v>document.documentElement.clientHeight-t.value:D());(y||p||r.value&&T.value)&&(V=[u,v],w.value=R(i.value?u:v,r.value),h.value=H(i.value?u:v),f=w.value>-20&&w.value<80,g(l),s(l))}function P(l){const u=l.changedTouches[0].clientX,v=l.changedTouches[0].clientY;if(f){if(!l.cancelable){f=!1;return}const y=Math.abs(u-V[0]),p=Math.abs(v-V[1]);(i.value?y>p&&y>3:p>y&&p>3)?(m.value=!0,f=!1):(i.value?p:y)>3&&(f=!1)}if(!m.value)return;l.preventDefault(),s(l);const d=H(i.value?u:v,!1);h.value=Math.max(0,Math.min(1,d)),d>1?w.value=R(i.value?u:v,!0):d<0&&(w.value=R(i.value?u:v,!1))}function O(l){if(f=!1,!m.value)return;s(l),m.value=!1;const u=a(l.changedTouches[0].identifier),v=Math.abs(u.x),d=Math.abs(u.y);(i.value?v>d&&v>400:d>v&&d>3)?r.value=u.direction===({left:"right",right:"left",top:"down",bottom:"up"}[n.value]||D()):r.value=h.value>.5}const Y=B(()=>m.value?{transform:n.value==="left"?`translateX(calc(-100% + ${h.value*t.value}px))`:n.value==="right"?`translateX(calc(100% - ${h.value*t.value}px))`:n.value==="top"?`translateY(calc(-100% + ${h.value*t.value}px))`:n.value==="bottom"?`translateY(calc(100% - ${h.value*t.value}px))`:D(),transition:"none"}:void 0);return F(m,()=>{var v,d;const l=((v=o.value)==null?void 0:v.style.transform)??null,u=((d=o.value)==null?void 0:d.style.transition)??null;Ve(()=>{var y,p,I,X;(p=o.value)==null||p.style.setProperty("transform",((y=Y.value)==null?void 0:y.transform)||"none"),(X=o.value)==null||X.style.setProperty("transition",((I=Y.value)==null?void 0:I.transition)||null)}),Te(()=>{var y,p;(y=o.value)==null||y.style.setProperty("transform",l),(p=o.value)==null||p.style.setProperty("transition",u)})}),{isDragging:m,dragProgress:h,dragStyles:Y}}function D(){throw new Error}const yt=["start","end","left","right","top","bottom"],pt=ve({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,persistent:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>yt.includes(e)},sticky:Boolean,...Ue(),...ze(),...Xe(),...Oe({mobile:null}),...We(),...Ae(),...$e(),...Ye({tag:"nav"}),...He()},"VNavigationDrawer"),wt=J()({name:"VNavigationDrawer",props:pt(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,o){let{attrs:r,emit:T,slots:t}=o;const{isRtl:c}=Se(),{themeClasses:n}=Be(e),{borderClasses:i}=xe(e),{backgroundColorClasses:s,backgroundColorStyles:g}=le(()=>e.color),{elevationClasses:a}=Ee(e),{displayClasses:f,mobile:m}=Pe(e),{roundedClasses:h}=_e(e),w=Ce(),V=Ie(e,"modelValue",null,k=>!!k),{ssrBootStyles:R}=ot(),{scopeId:H}=Me(),C=fe(),P=N(!1),{runOpenDelay:O,runCloseDelay:Y}=je(e,k=>{P.value=k}),l=B(()=>e.rail&&e.expandOnHover&&P.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),u=B(()=>Le(e.location,c.value)),v=Z(()=>e.persistent),d=B(()=>!e.permanent&&(m.value||e.temporary)),y=B(()=>e.sticky&&!d.value&&u.value!=="bottom");F(()=>e.expandOnHover&&e.rail!=null,()=>{A(P,k=>T("update:rail",!k))}),F(()=>!e.disableResizeWatcher,()=>{A(d,k=>!e.permanent&&Fe(()=>V.value=!k))}),F(()=>!e.disableRouteWatcher&&!!w,()=>{A(w.currentRoute,()=>d.value&&(V.value=!1))}),A(()=>e.permanent,k=>{k&&(V.value=!0)}),e.modelValue==null&&!d.value&&(V.value=e.permanent||!m.value);const{isDragging:p,dragProgress:I}=ht({el:C,isActive:V,isTemporary:d,width:l,touchless:Z(()=>e.touchless),position:u}),X=B(()=>{const k=d.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):l.value;return p.value?k*I.value:k}),{layoutItemStyles:Q,layoutItemScrimStyles:ge}=De({id:e.name,order:B(()=>parseInt(e.order,10)),position:u,layoutSize:X,elementSize:l,active:Ne(V),disableTransitions:Z(()=>p.value),absolute:B(()=>e.absolute||y.value&&typeof ee.value!="string")}),{isStuck:ee,stickyStyles:he}=vt({rootEl:C,isSticky:y,layoutItemStyles:Q}),te=le(()=>typeof e.scrim=="string"?e.scrim:null),ye=B(()=>({...p.value?{opacity:I.value*.2,transition:"none"}:void 0,...ge.value}));return Re({VList:{bgColor:"transparent"}}),K(()=>{const k=t.image||e.image;return E(W,null,[b(e.tag,q({ref:C,onMouseenter:O,onMouseleave:Y,class:["v-navigation-drawer",`v-navigation-drawer--${u.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":P.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":d.value,"v-navigation-drawer--persistent":v.value,"v-navigation-drawer--active":V.value,"v-navigation-drawer--sticky":y.value},n.value,s.value,i.value,f.value,a.value,h.value,e.class],style:[g.value,Q.value,R.value,he.value,e.style]},H,r),{default:()=>{var ae,oe,ne;return[k&&E("div",{key:"image",class:"v-navigation-drawer__img"},[t.image?b(Ze,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{alt:"",cover:!0,height:"inherit",src:e.image}}},t.image):b(qe,{key:"image-img",alt:"",cover:!0,height:"inherit",src:e.image},null)]),t.prepend&&E("div",{class:"v-navigation-drawer__prepend"},[(ae=t.prepend)==null?void 0:ae.call(t)]),E("div",{class:"v-navigation-drawer__content"},[(oe=t.default)==null?void 0:oe.call(t)]),t.append&&E("div",{class:"v-navigation-drawer__append"},[(ne=t.append)==null?void 0:ne.call(t)])]}}),b(Ge,{name:"fade-transition"},{default:()=>[d.value&&(p.value||V.value)&&!!e.scrim&&E("div",q({class:["v-navigation-drawer__scrim",te.backgroundColorClasses.value],style:[ye.value,te.backgroundColorStyles.value],onClick:()=>{v.value||(V.value=!1)}},H),null)]})])}),{isStuck:ee}}}),bt=""+new URL("logo-36Ddi4Dh.png",import.meta.url).href,Ct={__name:"default",setup(e){const o=Je(),r=Ke(),T=Qe(),t=fe(!1),c=B(()=>{const i=!!(o!=null&&o.isLoggedIn);return[{title:"首頁",to:"/",icon:"mdi-home",show:!0},{title:"登入/註冊",to:"/login",icon:"mdi-login",show:!i},{title:"收藏",to:"/favorite",icon:"mdi-bookmark-box-multiple",show:i},{title:"地圖",to:"/map",icon:"mdi-map",show:i},{title:"管理",to:"/admin",icon:"mdi-cog",show:i}]}),n=async()=>{try{await tt.logout()}catch(i){console.error(i)}o.logout(),T.push("/"),r({text:"登出成功！",snackbarProps:{color:"green"}})};return(i,s)=>{const g=et("router-view");return x(),z(W,null,[b(at,{style:{padding:"0 11.5%"}},{default:S(()=>[s[4]||(s[4]=E("img",{alt:"Logo",class:"mr-2",src:bt,style:{height:"32px",width:"32px"}},null,-1)),b(ct,{class:"d-flex align-center"},{default:S(()=>s[2]||(s[2]=[M("痕跡 ",-1),E("span",{class:"sub-title"},"無名客的無名小站",-1)])),_:1,__:[2]}),b(it,{class:"d-md-none",onClick:s[0]||(s[0]=a=>t.value=!t.value)}),(x(!0),z(W,null,re(c.value??[],a=>(x(),z(W,{key:a==null?void 0:a.to},[a&&a.show?(x(),_(G,{key:0,to:a.to,variant:"text",class:"d-none d-md-flex"},{default:S(()=>[b(j,{class:"mr-1",color:i.$route.path===a.to?"primary":"grey"},{default:S(()=>[M(U(a.icon),1)]),_:2},1032,["color"]),M(" "+U(a.title)+" ",1),a.to==="/favorite"&&L(o).favoriteTotal>0?(x(),_(se,{key:0,color:"red",content:L(o).favoriteTotal,floating:""},null,8,["content"])):$("",!0)]),_:2},1032,["to"])):$("",!0)],64))),128)),L(o).isLoggedIn?(x(),_(G,{key:0,"prepend-icon":"mdi-logout",onClick:n,class:"d-none d-md-flex"},{default:S(()=>s[3]||(s[3]=[M("登出",-1)])),_:1,__:[3]})):$("",!0)]),_:1,__:[4]}),b(wt,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a),temporary:"",class:"d-md-none"},{default:S(()=>[b(st,null,{default:S(()=>[(x(!0),z(W,null,re(c.value.filter(a=>a.show),a=>(x(),_(ue,{key:a.to,to:a.to,link:""},{default:S(()=>[b(j,{class:"mr-2"},{default:S(()=>[M(U(a.icon),1)]),_:2},1024),E("span",null,U(a.title),1),a.to==="/favorite"&&L(o).favoriteTotal>0?(x(),_(se,{key:0,color:"red",content:L(o).favoriteTotal,floating:""},null,8,["content"])):$("",!0)]),_:2},1032,["to"]))),128)),L(o).isLoggedIn?(x(),_(ue,{key:0,onClick:n},{default:S(()=>[b(j,{class:"mr-2"},{default:S(()=>s[5]||(s[5]=[M("mdi-logout",-1)])),_:1,__:[5]}),s[6]||(s[6]=E("span",null,"登出",-1))]),_:1,__:[6]})):$("",!0)]),_:1})]),_:1},8,["modelValue"]),b(nt,null,{default:S(()=>[(x(),_(g,{key:i.$route.fullPath}))]),_:1})],64)}}};export{Ct as default};
