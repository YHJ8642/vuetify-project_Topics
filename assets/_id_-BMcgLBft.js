import{G as pe,l as ge,p as be,r as K,bq as we,v as S,s as te,ak as he,O as Ne,D as j,E as Ve,R as M,z as ne,y as xe,m as ye,ay as ae,d,e as r,F as T,n as Pe,j as U,a5 as le,bd as De,bg as ke,br as Ie,a3 as Se,bs as Ee,bt as Ce,a8 as Fe,a9 as _e,ax as Te,a as Re,f as Be,o as Ae,w as V,t as q,a4 as Le,k as re,bf as Me,ac as Ue}from"./index-D-6Mnssc.js";import{p as $e}from"./article-Bo3C5Rqr.js";import{b as ue}from"./route-block-B_A1xBdJ.js";import{V as ze,a as G}from"./VRow-CVWgejyA.js";import{V as E}from"./VDivider-BYXbtmAE.js";import{V as Oe}from"./VContainer-Cg8QJWlH.js";const He=50,je=500;function qe(t){let{toggleUpDown:x}=t,u=-1,f=-1;pe(a);function y(i){a(),P(i),window.addEventListener("pointerup",a),document.addEventListener("blur",a),u=window.setTimeout(()=>{f=window.setInterval(()=>P(i),He)},je)}function a(){window.clearTimeout(u),window.clearInterval(f),window.removeEventListener("pointerup",a),document.removeEventListener("blur",a)}function P(i){x(i==="up")}return{holdStart:y,holdStop:a}}const Ge=be({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:t=>!t||t.length===1},...ke(Ie(),["modelValue","validationValue"])},"VNumberInput"),Ke=ge()({name:"VNumberInput",props:{...Ge()},emits:{"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,x){let{slots:u}=x;const f=K(),{holdStart:y,holdStop:a}=qe({toggleUpDown:O}),P=we(t),i=S(()=>P.isDisabled.value||P.isReadonly.value),D=te(t.focused),{decimalSeparator:s}=he(),l=S(()=>{var e;return((e=t.decimalSeparator)==null?void 0:e[0])||s.value});function w(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.precision,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const N=n==null?String(e):e.toFixed(n);if(D.value&&m)return Number(N).toString().replace(".",l.value);if(t.minFractionDigits===null||n!==null&&n<t.minFractionDigits)return N.replace(".",l.value);let[k,v]=N.split(".");return v=(v??"").padEnd(t.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${t.minFractionDigits}})0`,"g"),""),[k,v].filter(Boolean).join(l.value)}const o=Ne(t,"modelValue",null,e=>e??null,e=>e==null?e??null:j(Number(e),t.min,t.max)),C=te(null);Ve(()=>{D.value&&!i.value||(o.value==null?C.value=null:isNaN(o.value)||(C.value=w(o.value)))});const p=S({get:()=>C.value,set(e){if(e===null||e===""){o.value=null,C.value=null;return}const n=Number(e.replace(l.value,"."));!isNaN(n)&&n<=t.max&&n>=t.min&&(o.value=n,C.value=e)}}),$=S(()=>i.value?!1:(o.value??0)+t.step<=t.max),z=S(()=>i.value?!1:(o.value??0)-t.step>=t.min),c=S(()=>t.hideInput?"stacked":t.controlVariant),X=M(()=>c.value==="split"?"$plus":"$collapse"),Y=M(()=>c.value==="split"?"$minus":"$expand"),R=M(()=>c.value==="split"?"default":"small"),B=M(()=>c.value==="stacked"?"auto":"100%"),oe={props:{onClick:A,onPointerup:h,onPointerdown:J,onPointercancel:h}},ie={props:{onClick:A,onPointerup:h,onPointerdown:Q,onPointercancel:h}};ne(()=>t.precision,()=>W()),ne(()=>t.minFractionDigits,()=>W()),xe(()=>{H()});function Z(e){if(e==null)return 0;const n=e.toString(),m=n.indexOf(".");return~m?n.length-m:0}function O(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i.value)return;if(o.value==null){p.value=w(j(0,t.min,t.max));return}let n=Math.max(Z(o.value),Z(t.step));t.precision!=null&&(n=Math.max(n,t.precision)),e?$.value&&(p.value=w(o.value+t.step,n)):z.value&&(p.value=w(o.value-t.step,n))}function se(e){var L;if(!e.data)return;const n=e.target,{value:m,selectionStart:N,selectionEnd:k}=n??{},v=m?m.slice(0,N)+e.data+m.slice(k):e.data,I=Ee(v,t.precision,l.value);new RegExp(`^-?\\d*${Ce(l.value)}?\\d*$`).test(v)||(e.preventDefault(),n.value=I),t.precision!=null&&(((L=v.split(l.value)[1])==null?void 0:L.length)>t.precision&&(e.preventDefault(),n.value=I),t.precision===0&&v.includes(l.value)&&(e.preventDefault(),n.value=I))}async function ce(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),H(),await Se(),e.key==="ArrowDown"?O(!1):O())}function A(e){e.stopPropagation()}function h(e){const n=e.currentTarget;n==null||n.releasePointerCapture(e.pointerId),e.preventDefault(),a()}function J(e){const n=e.currentTarget;n==null||n.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),y("up")}function Q(e){const n=e.currentTarget;n==null||n.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),y("down")}function H(){if(i.value||!f.value)return;const e=f.value.value,n=Number(e.replace(l.value,"."));e&&!isNaN(n)?p.value=w(j(n,t.min,t.max)):p.value=null}function W(){i.value||(p.value=o.value!==null&&!isNaN(o.value)?w(o.value,t.precision,!1):null)}function de(){if(!i.value){if(o.value===null||isNaN(o.value)){p.value=null;return}p.value=o.value.toString().replace(".",l.value)}}function me(){de()}function ve(){H()}return ye(()=>{const{modelValue:e,...n}=ae.filterProps(t);function m(){return u.increment?r(le,{key:"increment-defaults",defaults:{VBtn:{disabled:!$.value,flat:!0,height:B.value,size:R.value,icon:X.value}}},{default:()=>[u.increment(oe)]}):r(U,{"aria-hidden":"true","data-testid":"increment",disabled:!$.value,flat:!0,height:B.value,icon:X.value,key:"increment-btn",onClick:A,onPointerdown:J,onPointerup:h,onPointercancel:h,size:R.value,tabindex:"-1"},null)}function N(){return u.decrement?r(le,{key:"decrement-defaults",defaults:{VBtn:{disabled:!z.value,flat:!0,height:B.value,size:R.value,icon:Y.value}}},{default:()=>[u.decrement(ie)]}):r(U,{"aria-hidden":"true","data-testid":"decrement",disabled:!z.value,flat:!0,height:B.value,icon:Y.value,key:"decrement-btn",onClick:A,onPointerdown:Q,onPointerup:h,onPointercancel:h,size:R.value,tabindex:"-1"},null)}function k(){return d("div",{class:"v-number-input__control"},[N(),r(E,{vertical:c.value!=="stacked"},null),m()])}function v(){return!t.hideInput&&!t.inset?r(E,{vertical:!0},null):void 0}const I=c.value==="split"?d("div",{class:"v-number-input__control"},[r(E,{vertical:!0},null),m()]):t.reverse||c.value==="hidden"?void 0:d(T,null,[v(),k()]),L=u["append-inner"]||I,ee=c.value==="split"?d("div",{class:"v-number-input__control"},[N(),r(E,{vertical:!0},null)]):t.reverse&&c.value!=="hidden"?d(T,null,[k(),v()]):void 0,fe=u["prepend-inner"]||ee;return r(ae,Pe({ref:f},n,{modelValue:p.value,"onUpdate:modelValue":g=>p.value=g,focused:D.value,"onUpdate:focused":g=>D.value=g,validationValue:o.value,onBeforeinput:se,onFocus:me,onBlur:ve,onKeydown:ce,class:["v-number-input",{"v-number-input--default":c.value==="default","v-number-input--hide-input":t.hideInput,"v-number-input--inset":t.inset,"v-number-input--reverse":t.reverse,"v-number-input--split":c.value==="split","v-number-input--stacked":c.value==="stacked"},t.class],style:t.style,inputmode:"decimal"}),{...u,"append-inner":L?function(){var _;for(var g=arguments.length,F=new Array(g),b=0;b<g;b++)F[b]=arguments[b];return d(T,null,[(_=u["append-inner"])==null?void 0:_.call(u,...F),I])}:void 0,"prepend-inner":fe?function(){var _;for(var g=arguments.length,F=new Array(g),b=0;b<g;b++)F[b]=arguments[b];return d(T,null,[ee,(_=u["prepend-inner"])==null?void 0:_.call(u,...F)])}:void 0})}),De({},f)}}),Xe={class:"text-center"},Ye={style:{"white-space":"pre"}},Ze={__name:"[id]",setup(t){const x=Fe(),u=_e(),f=Te(),y=Re(),a=K({title:"",location:"",description:"",category:"",release:!0,image:""});(async()=>{try{const{data:s}=await $e.getId(f.params.id);a.value.title=s.product.title,a.value.location=s.product.location,a.value.description=s.product.description,a.value.category=s.product.category,a.value.release=s.product.release,a.value.image=s.product.image,document.title=`${s.product.title} | 痕跡`}catch(s){console.error("Error fetching products:",s),x({text:"無法載入商品資料",snackbarProps:{color:"red"}}),u.push("/")}})();const i=K(1),D=async()=>{try{const{data:s}=await Ue.cart({product:f.params.id,quantity:i.value});y.cartTotal=s.result,x({text:"已加入購物車",snackbarProps:{color:"green"}})}catch(s){console.error("Error fetching products:",s),x({text:"無法加入購物車",snackbarProps:{color:"red"}}),u.push("/")}};return(s,l)=>(Ae(),Be(T,null,[r(Oe,null,{default:V(()=>[r(ze,null,{default:V(()=>[r(G,{cols:"12"},{default:V(()=>[d("h1",Xe,q(a.value.title),1)]),_:1}),r(E),r(G,{cols:"12",md:"6"},{default:V(()=>[r(Le,{class:"mb-4",contain:"",height:"400",src:a.value.image},null,8,["src"])]),_:1}),r(G,{cols:"12",md:"6"},{default:V(()=>[d("p",null,"分類: "+q(a.value.category),1),r(E,{class:"my-5"}),d("p",Ye,q(a.value.description),1),r(Ke,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=w=>i.value=w),"control-variant":"split",min:1,variant:"outlined"},null,8,["modelValue"]),r(U,{class:"mt-4",color:"primary",disabled:!a.value.release,onClick:D},{default:V(()=>l[1]||(l[1]=[re(" 加入購物車 ",-1)])),_:1,__:[1]},8,["disabled"])]),_:1})]),_:1})]),_:1}),r(Me,{class:"align-center justify-center text-center","model-value":!a.value.release,opacity:"0.7",persistent:"",scrim:"black"},{default:V(()=>[l[3]||(l[3]=d("h1",null,"已下架",-1)),l[4]||(l[4]=d("p",null,"這個商品已經下架，無法購買。",-1)),r(U,{color:"primary",to:"/"},{default:V(()=>l[2]||(l[2]=[re(" 返回首頁 ",-1)])),_:1,__:[2]})]),_:1,__:[3,4]},8,["model-value"])],64))}};typeof ue=="function"&&ue(Ze);export{Ze as default};
